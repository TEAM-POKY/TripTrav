CREATE TABLE `user` (
	`uno` bigint AUTO_INCREMENT PRIMARY KEY,
	`email` varchar(255) NOT NULL,
	`pw` varchar(255) NULL,
	`nickname` varchar(64) NOT NULL,
	`profile` varchar(500) NULL,
	`provider` varchar(255) NULL,
	`provider_id` varchar(255) NULL
);

CREATE TABLE `auth` (
	`uno` bigint,
	`role` varchar(20) NOT NULL,
	FOREIGN KEY (`uno`) REFERENCES `user`(`uno`)
);

CREATE TABLE `review` (
	`rno` bigint AUTO_INCREMENT PRIMARY KEY,
	`uno` bigint NOT NULL,
	`nickname` varchar(64) NOT NULL,
	`re_rate` float NULL,
	`re_content` text NULL,
	`re_date` datetime NULL DEFAULT NOW(),
	`re_useful` bigint NULL DEFAULT 0,
	`re_report` int NULL DEFAULT 0,
	`re_image_count` int NULL,
	`re_content_id` bigint NOT NULL,
	`re_content_type` bigint NOT NULL,
	`re_content_name` text NOT NULL,
	FOREIGN KEY (`uno`) REFERENCES `user`(`uno`)
);

CREATE TABLE `review_image` (
    `ri_id` bigint AUTO_INCREMENT PRIMARY KEY,
    `rno` bigint NOT NULL,
    `image_path` varchar(500) NOT NULL,
    `upload_date` datetime DEFAULT NOW(),
    FOREIGN KEY (`rno`) REFERENCES `review`(`rno`) ON DELETE CASCADE
);

CREATE TABLE `review_like` (
    `rno` bigint NOT NULL,
    `uno` bigint NOT NULL,
    FOREIGN KEY (`rno`) REFERENCES `review`(`rno`) ON DELETE CASCADE,
    UNIQUE (`rno`, `uno`)
);

CREATE TABLE `review_report` (
    `rr_id` bigint AUTO_INCREMENT PRIMARY KEY,
    `rno` bigint NOT NULL,
    `uno` bigint NOT NULL,
    `report_reason` varchar(255) NULL,
    FOREIGN KEY (`rno`) REFERENCES `review`(`rno`) ON DELETE CASCADE,
    UNIQUE (`rno`, `uno`)
);

CREATE TABLE `schedule` (
	`sco` bigint AUTO_INCREMENT PRIMARY KEY,
	`sche_name` varchar(64) NOT NULL,
	`sche_start` datetime NOT NULL,
	`sche_end` datetime NOT NULL,
	`sche_count` int NOT NULL,
	`sche_memo` int NULL DEFAULT 0,
	`sche_img` varchar(200) NULL,
	`uno` bigint NOT NULL,
	FOREIGN KEY (`uno`) REFERENCES `user`(`uno`)
);

CREATE TABLE `schedule_role` (
	`sche_role` int NOT NULL DEFAULT 0,
	`sco` bigint NOT NULL,
	`uno` bigint NOT NULL,
	FOREIGN KEY (`sco`) REFERENCES `schedule`(`sco`),
	FOREIGN KEY (`uno`) REFERENCES `user`(`uno`)
);

CREATE TABLE `schedule_detail` (
	`sco` bigint NOT NULL,
	`sche_content_id` bigint NOT NULL,
	`sche_title` text NOT NULL,
	`sche_index` int NOT NULL,
	`sche_date` int NOT NULL,
	FOREIGN KEY (`sco`) REFERENCES `schedule`(`sco`)
);

CREATE TABLE `schedule_memo` (
    `sco` bigint NOT NULL,
    `sche_memo_writer` varchar(64) NULL,
    `sche_memo_content` text NULL,
    FOREIGN KEY (`sco`) REFERENCES `schedule`(`sco`)
);

CREATE TABLE `schedule_companion` (
    `uno` bigint NOT NULL,
    `sco` bigint NOT NULL,
    `sche_nick` varchar(64) NOT NULL,
    FOREIGN KEY (`uno`) REFERENCES `user`(`uno`) ON DELETE CASCADE,
    FOREIGN KEY (`sco`) REFERENCES `schedule`(`sco`) ON DELETE CASCADE,
    UNIQUE (`uno`)
);

CREATE TABLE `like` (
	`uno` bigint NOT NULL,
	`like_code` bigint NOT NULL,
	`like_name` text NOT NULL,
	FOREIGN KEY (`uno`) REFERENCES `user`(`uno`)
);

CREATE TABLE `category` (
    `category_id` int AUTO_INCREMENT PRIMARY KEY,
    `category_code` text NOT NULL
);

CREATE TABLE `taste` (
    `tno` bigint AUTO_INCREMENT PRIMARY KEY,
    `uno` bigint NOT NULL,
    `category_id` int NOT NULL,
    FOREIGN KEY (`uno`) REFERENCES `user`(`uno`),
    FOREIGN KEY (`category_id`) REFERENCES `category`(`category_id`)
);
